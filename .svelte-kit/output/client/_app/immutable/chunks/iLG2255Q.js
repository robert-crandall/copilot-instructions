import{an as M,u as g,B as L,ao as N,ap as H,aq as x}from"./dupZhlXE.js";import{i as O,a as P,b as R,c as D}from"./BnM-H2vA.js";let E=!1;function I(){E||(E=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var a;if(!t.defaultPrevented)for(const e of t.target.elements)(a=e.__on_r)==null||a.call(e)})},{capture:!0}))}function j(t,a,e){M(()=>{var i=g(()=>a(t,e==null?void 0:e())||{});if(i!=null&&i.destroy)return()=>i.destroy()})}const C=Symbol("is custom element"),F=Symbol("is html");function z(t){if(L){var a=!1,e=()=>{if(!a){if(a=!0,t.hasAttribute("value")){var i=t.value;v(t,"value",null),t.value=i}if(t.hasAttribute("checked")){var r=t.checked;v(t,"checked",null),t.checked=r}}};t.__on_r=e,N(e),I()}}function J(t,a){var e=S(t);e.value===(e.value=a??void 0)||t.value===a&&(a!==0||t.nodeName!=="PROGRESS")||(t.value=a??"")}function v(t,a,e,i){var r=S(t);L&&(r[a]=t.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&t.nodeName==="LINK")||r[a]!==(r[a]=e)&&(a==="loading"&&(t[x]=e),t.removeAttribute(a))}function S(t){return t.__attributes??(t.__attributes={[C]:t.nodeName.includes("-"),[F]:t.namespaceURI===H})}function U(t){const a=JSON.parse(t);return a.data&&(a.data=R(a.data,D.decoders)),a}function d(t){return HTMLElement.prototype.cloneNode.call(t)}function K(t,a=()=>{}){const e=async({action:r,result:u,reset:n=!0,invalidateAll:s=!0})=>{u.type==="success"&&(n&&HTMLFormElement.prototype.reset.call(t),s&&await O()),(location.origin+location.pathname===r.origin+r.pathname||u.type==="redirect"||u.type==="error")&&await P(u)};async function i(r){var b,h,y,_,A;if(((b=r.submitter)!=null&&b.hasAttribute("formmethod")?r.submitter.formMethod:d(t).method)!=="post")return;r.preventDefault();const n=new URL((h=r.submitter)!=null&&h.hasAttribute("formaction")?r.submitter.formAction:d(t).action),s=(y=r.submitter)!=null&&y.hasAttribute("formenctype")?r.submitter.formEnctype:d(t).enctype,l=new FormData(t),f=(_=r.submitter)==null?void 0:_.getAttribute("name");f&&l.append(f,((A=r.submitter)==null?void 0:A.getAttribute("value"))??"");const m=new AbortController;let p=!1;const T=await a({action:n,cancel:()=>p=!0,controller:m,formData:l,formElement:t,submitter:r.submitter})??e;if(p)return;let c;try{const o=new Headers({accept:"application/json","x-sveltekit-action":"true"});s!=="multipart/form-data"&&o.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(s)?s:"application/x-www-form-urlencoded");const k=s==="multipart/form-data"?l:new URLSearchParams(l),w=await fetch(n,{method:"POST",headers:o,cache:"no-store",body:k,signal:m.signal});c=U(await w.text()),c.type==="error"&&(c.status=w.status)}catch(o){if((o==null?void 0:o.name)==="AbortError")return;c={type:"error",error:o}}await T({action:n,formData:l,formElement:t,update:o=>e({action:n,result:c,reset:o==null?void 0:o.reset,invalidateAll:o==null?void 0:o.invalidateAll}),result:c})}return HTMLFormElement.prototype.addEventListener.call(t,"submit",i),{destroy(){HTMLFormElement.prototype.removeEventListener.call(t,"submit",i)}}}export{j as a,K as e,z as r,J as s};
